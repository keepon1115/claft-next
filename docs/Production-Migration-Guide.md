# 本番コンテンツ移行ガイド & プロンプト集

## 🎯 移行戦略概要

### 基本方針
- ✅ **現在の安定版を必ず保持**（ロールバック用）
- ✅ **機能単位で段階的に移行**
- ✅ **各段階で動作確認**
- ✅ **パフォーマンス監視継続**

---

## 📋 Phase 1: 安全な準備作業（✅ 完了）

### 1. 現在の安定版をブランチ保存
```bash
# ✅ 完了：現在の状態を保存
git add .
git commit -m "安定版：基盤構築完了 - すべてのコンポーネント正常動作"

# ✅ 完了：安定版ブランチを作成
git branch stable-base-v1

# ✅ 完了：本番移行用の新ブランチ作成
git checkout -b production-migration
```

**これで、問題が発生しても `git checkout stable-base-v1` で即座に戻れます。**

### 2. バックアップファイルの確認（✅ 完了）

**復活対象の主要ファイル:**
- **`userStore.ts.bak`** (32KB) - 完全なユーザー管理システム
  - プロフィール管理
  - レベル・経験値システム
  - 実績システム
  - Supabase連携 + 開発モード対応
- **`JibunCraft.tsx.bak`** (20KB) - メインUI機能
  - 5つの力メーター可視化
  - スキルタブシステム
  - レベルアップモーダル
  - リッチなアニメーション

---

## 🚀 Phase 2: userStore復活（優先度：最高）

### 目標
Zustand状態管理の完全復活で、アプリケーションの中核機能を有効化

### 実行手順

#### 1. 現在のuserStoreバックアップ
```bash
# 現在のuserStoreを保存
cp stores/userStore.ts stores/userStore.ts.minimal
```

#### 2. 段階的復活戦略
```bash
# ステップ1: 基本型定義のみ追加
# ステップ2: デフォルト値追加
# ステップ3: 基本アクション追加
# ステップ4: Supabase連携追加
```

#### 3. 動作確認チェックリスト
- [ ] **TypeScriptエラー0個**
- [ ] **プロセス数 ≤ 4個**
- [ ] **メモリ使用量 ≤ 700MB**
- [ ] **ページ表示正常**
- [ ] **console.logでデータ確認**

### プロンプト例
```
現在のuserStore.tsを userStore.ts.bak の内容で段階的に置き換えたいです。

まず最初に：
1. 基本的な型定義のみ追加
2. 動作確認
3. 問題がなければ次のステップへ

安全性を最優先に、一度に大きな変更はしないでください。
```

---

## 🎨 Phase 3: JibunCraft UI復活（優先度：高）

### 目標
メインページの魅力的なUI復活

### 前提条件
- ✅ userStore復活完了
- ✅ 基本状態管理動作確認済み

### 実行手順

#### 1. 最小版JibunCraftを作成
```tsx
// 最初はシンプルな表示のみ
const JibunCraft = () => {
  return <div>JibunCraft機能準備中</div>
}
```

#### 2. 段階的機能追加
```bash
# ステップ1: 基本構造のみ
# ステップ2: パワーメーター追加
# ステップ3: スキルタブ追加
# ステップ4: アニメーション追加
```

#### 3. スタイリング統合
```bash
# globals.cssに統合 or CSS Modulesで分離
# TailwindCSSとCSS-in-JSの共存確認
```

### プロンプト例
```
app/page.tsx にJibunCraftコンポーネントを段階的に追加したいです。

JibunCraft.tsx.bak の内容を参考に：
1. まずは基本構造のみの最小版を作成
2. TailwindCSSと既存スタイルの競合チェック
3. 問題なければパワーメーター機能を追加

安全第一で進めてください。
```

---

## 🔧 Phase 4: 高度な機能復活（優先度：中）

### 対象機能
- **認証システム強化** - AuthProviderの完全版
- **クエストシステム** - StageModal、QuestMap復活
- **管理画面** - FilterSection、ApprovalTable復活
- **プロフィール管理** - ProfileCard高度化

### 復活順序
1. **AuthProvider拡張** → ログイン・ログアウト機能
2. **ProfileCard拡張** → ユーザー情報表示
3. **クエスト機能** → ゲーム要素追加
4. **管理画面** → 管理者機能

---

## 📊 各Phase後の成功基準チェックリスト

**必須確認項目（毎回）:**
- [ ] **ブラウザでページが表示される** - HTTP 200 OK
- [ ] **スタイルが適用されている** - TailwindCSS + カスタムスタイル
- [ ] **コンソールエラーがない** - 開発者ツールチェック
- [ ] **Node.jsプロセスが4個以下** - `tasklist | findstr node.exe`
- [ ] **メモリ使用量が700MB以下** - タスクマネージャー確認
- [ ] **ファンが静か** - CPU使用率正常
- [ ] **既存機能が動作する** - 回帰テスト

**追加確認項目（機能追加時）:**
- [ ] **新機能が正常動作** - 期待通りの動作
- [ ] **既存機能に影響なし** - 競合チェック
- [ ] **TypeScriptエラー0個** - 型安全性維持
- [ ] **Supabase連携動作** - データベース操作確認

---

## 🚨 緊急時ロールバック手順

### 問題発生時の即座対応
```bash
# 1. サーバー即停止
taskkill /f /im node.exe

# 2. 安定版に戻る
git checkout stable-base-v1

# 3. キャッシュクリア
Remove-Item -Recurse -Force .next

# 4. 再起動
npm run dev
```

### 部分的ロールバック
```bash
# 特定ファイルのみ戻す
git checkout stable-base-v1 -- stores/userStore.ts
git checkout stable-base-v1 -- components/home/JibunCraft.tsx
```

---

## 🎯 最終目標

**Phase 2-4完了後の達成状態:**
- ✅ **完全なユーザー管理システム** - プロフィール、レベル、実績
- ✅ **魅力的なメインUI** - パワーメーター、スキルタブ
- ✅ **認証・クエストシステム** - ゲーム要素統合
- ✅ **管理画面機能** - 完全な管理者ツール
- ✅ **安定したパフォーマンス** - 最適化完了

---

## 💡 重要な注意事項

### 開発時の原則
1. **必ず1つずつ追加** - 複数機能同時追加禁止
2. **毎回動作確認** - チェックリスト必須実行
3. **バックアップ保持** - 常にロールバック可能
4. **プロセス監視** - 異常時は即座停止
5. **型安全性** - TypeScriptエラー0個維持

### 成功のコツ
- **焦らない** - 安全性が最優先
- **記録する** - 変更内容を詳細記録
- **テストする** - 小さな変更でも確認
- **監視する** - システムリソース常時チェック

---

**🔗 関連ドキュメント:**
- [Emergency-Recovery-Guide.md](./Emergency-Recovery-Guide.md)
- [Performance-Optimization-Guide.md](./Performance-Optimization-Guide.md)

**📅 作成日:** 復旧作業完了時  
**📝 最終更新:** Phase 1完了 